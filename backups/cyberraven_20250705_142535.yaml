# CyberRaven Configuration File
# Professional Security Assessment Tool
# https://github.com/ajkula/cyberraven

# Engine Configuration - Controls attack execution behavior
engine:
  max_workers: 10          # Maximum concurrent attack workers
  timeout: 30s            # Timeout for individual operations
  rate_limit: 10          # Requests per second limit
  max_retries: 3          # Maximum retry attempts for failed requests
  retry_delay: 1s         # Delay between retry attempts

# Target Configuration - Define your target system
target:
  name: "My Target Application"
  description: "Target system for security assessment"
  base_url: "https://localhost:8080/ui/"  # Change this to your target URL
  
  # Custom headers to include in all requests
  headers:
    # "User-Agent": "CyberRaven Security Scanner"
    # "X-Custom-Header": "value"
  
  # Authentication configuration
  auth:
    type: "none"           # Options: none, basic, bearer, jwt, hmac, custom
    # username: "admin"    # For basic auth
    # password: "secret"   # For basic auth
    # token: "jwt_token"   # For bearer/jwt auth
    # custom_headers:      # For custom auth
    #   "Authorization": "Custom auth_value"
    
    # HMAC Authentication (when type: "hmac")
    hmac:
      secret: ""                    # HMAC secret key (required for HMAC auth)
      algorithm: "sha256"           # HMAC algorithm: sha256, sha512
      signature_header: "X-Signature"    # Header name for HMAC signature
      timestamp_header: "X-Timestamp"    # Header name for timestamp
      timestamp_tolerance: "5m"           # Tolerance for timestamp validation
  
  # TLS/SSL Configuration
  tls:
    insecure_skip_verify: true  # Skip certificate verification (for testing only)
    # ca_cert_path: "/path/to/ca.crt"      # Custom CA certificate
    # client_cert_path: "/path/to/cert.crt" # Client certificate for mutual TLS
    # client_key_path: "/path/to/key.key"   # Client private key
    # min_version: "1.2"   # Minimum TLS version
    # max_version: "1.3"   # Maximum TLS version

# Attack Modules Configuration
attacks:
  enabled: []              # Empty = all modules, or specify: ["api", "jwt", "injection"]
  aggressive: false        # Enable aggressive testing mode
  
  # API Enumeration Module
  api:
    enable: true
    test_enumeration: true
    test_method_tampering: true
    test_parameter_pollution: true
    # common_endpoints:      # Custom endpoints to test
    #   - "/api/users"
    #   - "/admin/dashboard"
    # wordlists:             # Custom wordlists for enumeration
    #   - "/path/to/wordlist.txt"
  
  # JWT Security Testing Module
  jwt:
    enable: true
    test_alg_none: true      # Test "none" algorithm bypass
    test_alg_confusion: true # Test algorithm confusion attacks
    test_weak_secrets: true  # Test weak HMAC secrets
    test_expiration: true    # Test expiration bypass
    # weak_secrets:          # Custom weak secrets to test
    #   - "secret"
    #   - "password123"
    #   - "your-256-bit-secret"
  
  # Injection Testing Module
  injection:
    enable: true
    test_sql: true          # Test SQL injection
    test_nosql: true        # Test NoSQL injection
    test_json: true         # Test JSON injection
    test_path: true         # Test path traversal
    # sql_payloads:          # Custom SQL injection payloads
    #   - "' OR 1=1--"
    #   - "'; DROP TABLE users--"
    # nosql_payloads:        # Custom NoSQL injection payloads
    #   - '{"$where": "1==1"}'
    # json_payloads:         # Custom JSON injection payloads
    #   - '{"test": "${java:os}"}'
    # path_payloads:         # Custom path traversal payloads
    #   - "../../../etc/passwd"
  
  # HMAC Security Testing Module
  hmac:
    enable: true
    test_replay: true       # Test replay attacks
    test_timing: true       # Test timing attacks
    replay_window: "5m"     # Time window for replay attack testing
    timing_requests: 50     # Number of requests for timing analysis

  # DoS Security Testing Module
  dos:
    enable: true
    test_flooding: true      # Test request flooding attacks
    test_large_payloads: true # Test large payload attacks  
    test_conn_exhaustion: true # Test connection exhaustion
    flooding_duration: "10s" # Duration of flooding tests (keep short!)
    flooding_rate: 20        # Requests per second for flooding
    max_payload_size: 5242880 # Maximum payload size (5MB)
    max_connections: 10      # Maximum concurrent connections

  # TLS Security Testing Module
  tls:
    enable: true
    test_cipher_suites: true     # Test cipher suite security
    test_certificates: true      # Test certificate validation
    test_downgrade: true         # Test protocol downgrade attacks
    test_self_signed: true       # Test self-signed certificate handling
    test_expired_certs: true     # Test expired certificate handling
    # weak_ciphers:              # Custom weak ciphers to test
    #   - "TLS_RSA_WITH_RC4_128_SHA"
    #   - "TLS_RSA_WITH_3DES_EDE_CBC_SHA"

# Reporting Configuration
reports:
  formats: ["html", "json", "txt"]  # Available: html, json, pdf, txt
  output_dir: "./reports"           # Directory for generated reports
  template: ""                      # Custom report template (optional)
  include_logs: true               # Include detailed logs in reports
  include_raw_data: false          # Include raw HTTP requests/responses
  severity_levels: ["low", "medium", "high", "critical"]  # Severity levels to include

# Output and UI Configuration
output:
  verbosity: "normal"      # Options: silent, minimal, normal, verbose, debug
  colors: true            # Enable colored terminal output
  progress_bars: true     # Show progress bars during scanning
  interactive: false      # Enable interactive mode
  real_time: true        # Real-time output during scanning
  show_banner: true      # Show ASCII art banner

# Logging Configuration
logging:
  level: "info"           # Options: debug, info, warn, error
  format: "text"          # Options: text, json
  output_file: ""         # Log file path (empty = stdout only)
  rotation: false         # Enable log rotation
  max_size: 100          # Maximum log file size in MB
  max_backups: 3         # Maximum number of old log files
  max_age: 28            # Maximum age of log files in days

# Profile Configuration (Advanced)
# You can define custom attack profiles for different target types
# profiles:
#   webapp-generic:
#     description: "Generic web application testing"
#     attacks:
#       enabled: ["api", "injection"]
#       api:
#         common_endpoints: ["/login", "/admin", "/api"]
#   
#   api-rest:
#     description: "REST API focused testing"
#     attacks:
#       enabled: ["api", "jwt"]
#       api:
#         test_method_tampering: true
#
#   messaging-system:
#     description: "Real-time messaging system testing"
#     attacks:
#       enabled: ["api", "jwt", "injection", "hmac", "dos", "tls"]
#       aggressive: true
